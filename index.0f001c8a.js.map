{"mappings":"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","sources":["src/js/popup.js","src/js/localStorage.js","src/js/createMarkupModalShopList.js"],"sourcesContent":["import { BookAPI } from './bookAPI';\nimport storage from './localStorage';\nimport { createBookMarkup } from './createMarkupModalShopList';\n\nlet BOOK_ID;\nconst KEY_LS = 'booksInShopingList';\nlet BOOKS_IDS = {\n  id: [],\n};\nconst api = new BookAPI();\nconst { save, load } = storage;\n\nconst booksContainerEl = document.querySelector(\n  '[data-action=\"booksContainer\"]'\n);\nconst backdropEl = document.querySelector('.js-backdrop');\nconst markDataContainerEl = document.querySelector(\n  '[data-action=\"popup-data-markup\"]'\n);\nconst closePopupBtnEl = document.querySelector('.close-popup');\nconst addBookBtnEl = document.querySelector('.add-book-button');\nconst removeBookBtnEl = document.querySelector('.remove-book-button');\nconst removeBookTextEl = document.querySelector('.remove-book-text');\n\nbooksContainerEl.addEventListener('click', onBooksContainerClick);\nbackdropEl.addEventListener('click', onBackdropClick);\nclosePopupBtnEl.addEventListener('click', onCloseBtnClick);\naddBookBtnEl.addEventListener('click', onAddBookBtnClick);\nremoveBookBtnEl.addEventListener('click', onRemoveBookBtnClick);\n\nasync function onBooksContainerClick(e) {\n  e.preventDefault();\n  if (e.currentTarget === e.target) {\n    return;\n  }\n  if (e.target.dataset.role === 'see-more-btn') {\n    return;\n  }\n\n  // Тут робимо запит і передаємо данні на відмальовку у функцію\n  BOOK_ID = e.target.closest('.book-card').dataset.id;\n  api.id = BOOK_ID;\n  const { book_image, title, author, description, buy_links } =\n    await api.getBooksById();\n  markDataContainerEl.innerHTML = createBookMarkup(\n    book_image,\n    title,\n    author,\n    description,\n    buy_links[0].url,\n    buy_links[1].url,\n    buy_links[2].url\n  );\n\n  // Звертаємося до локалки і перевіряємо наявність книжки, в залеж. від відповіді виводим кнопку\n  // додати або видалити\n  BOOKS_IDS = load(KEY_LS) || {\n    id: [],\n  };\n  if (BOOKS_IDS.id.includes(BOOK_ID)) {\n    showAddOrRemoveBtn(true);\n  } else {\n    showAddOrRemoveBtn(false);\n  }\n\n  window.addEventListener('keydown', onEscPress);\n  document.body.classList.add('show-popup');\n}\n\n// Показуємо кнопку в залежності від значення флажка true or false.\nfunction showAddOrRemoveBtn(bookInLs) {\n  if (bookInLs) {\n    removeBookBtnEl.removeAttribute('hidden');\n    removeBookTextEl.removeAttribute('hidden');\n  } else {\n    addBookBtnEl.removeAttribute('hidden');\n  }\n}\n\nfunction onAddBookBtnClick() {\n  // Записуємо данні в локал сторейдж\n  // Замінюємо кнопку на ремув\n  BOOKS_IDS.id.push(BOOK_ID);\n  save(KEY_LS, BOOKS_IDS);\n\n  addBookBtnEl.setAttribute('hidden', true);\n  removeBookBtnEl.removeAttribute('hidden');\n  removeBookTextEl.removeAttribute('hidden');\n}\n\nfunction onRemoveBookBtnClick() {\n  // Видаляємо дані з локалки\n  // Замінюємо кнопку на едд\n  const newArrr = BOOKS_IDS.id.filter(item => item !== BOOK_ID);\n  BOOKS_IDS.id = newArrr;\n  save(KEY_LS, BOOKS_IDS);\n  removeBookBtnEl.setAttribute('hidden', true);\n  removeBookTextEl.setAttribute('hidden', true);\n  addBookBtnEl.removeAttribute('hidden');\n}\n\nfunction onCloseBtnClick() {\n  window.removeEventListener('keydown', onEscPress);\n  document.body.classList.remove('show-popup');\n\n  addBookBtnEl.setAttribute('hidden', true);\n  removeBookBtnEl.setAttribute('hidden', true);\n  removeBookTextEl.setAttribute('hidden', true);\n}\n\nfunction onBackdropClick(e) {\n  if (e.currentTarget === e.target) {\n    onCloseBtnClick();\n  }\n}\n\nfunction onEscPress(e) {\n  if (e.code === 'Escape') {\n    onCloseBtnClick();\n  }\n}\n\nexport { BOOKS_IDS };\n","// Файлик для работы с локальным хранилищем\n\n// Использовать вот так\n// import storage from './storage';\n// const { save, load } = storage;\n// save(CONST_ID, data); // Запись в local storage\n// const playerNewTime = load(CONST_ID); // Чтение\n\nconst save = (key, value) => {\n  try {\n    const serializedState = JSON.stringify(value);\n    localStorage.setItem(key, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n};\n\nconst load = key => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nconst remove = key => {\n  try {\n    localStorage.removeItem(key);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nconst clear = () => {\n  try {\n    localStorage.clear();\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nexport default {\n  save,\n  load,\n  remove,\n  clear,\n};\n","export function createBookMarkup(\n  bookImg,\n  title,\n  author,\n  description,\n  urlAmaz,\n  urlApBooks,\n  urlBarnAndNob\n) {\n  return `<img src=\"${\n    bookImg || 'src/images/noimage/noImage-desk@2x.png'\n  }\" alt=\"book cover: ${title || 'No title'}\"\n  width=\"100\" height=\"100\">\n  <h2>${title || 'No title'}</h2>\n  <p>${author || 'No author'}</p>\n  <p>${description || 'No description'}</p>\n  <a href=\"${urlAmaz}\" target=\"_blank\" rel=\"noreferrer noopener\">Amazon</a>\n<a href=\"${urlApBooks}\" target=\"_blank\" rel=\"noreferrer noopener\">Apple Books</a>\n<a href=\"${urlBarnAndNob}\" target=\"_blank\" rel=\"noreferrer noopener\">Barnes and Noble</a>`;\n}\n"],"names":["$hkoFk","parcelRequire","$2338c8cd734f85a6$export$2e2bcd8739ae039","key","value","serializedState","JSON","stringify","localStorage","setItem","error","console","message","getItem","undefined","parse","removeItem","clear","$cef1c51f78cb2c6b$export$fc330cc8afb2a391","bookImg","title","author","description","urlAmaz","urlApBooks","urlBarnAndNob","$8eba2bb3fe686d91$var$BOOK_ID","$8eba2bb3fe686d91$export$1381f8da19e39170","id","$8eba2bb3fe686d91$var$api","BookAPI","save","$8eba2bb3fe686d91$var$save","load","$8eba2bb3fe686d91$var$load","$8eba2bb3fe686d91$var$booksContainerEl","document","querySelector","$8eba2bb3fe686d91$var$backdropEl","$8eba2bb3fe686d91$var$markDataContainerEl","$8eba2bb3fe686d91$var$closePopupBtnEl","$8eba2bb3fe686d91$var$addBookBtnEl","$8eba2bb3fe686d91$var$removeBookBtnEl","$8eba2bb3fe686d91$var$removeBookTextEl","$8eba2bb3fe686d91$var$showAddOrRemoveBtn","bookInLs","removeAttribute","$8eba2bb3fe686d91$var$onCloseBtnClick","window","removeEventListener","$8eba2bb3fe686d91$var$onEscPress","body","classList","remove","setAttribute","e","code","addEventListener","async","preventDefault","currentTarget","target","dataset","role","closest","book_image","buy_links","getBooksById","innerHTML","url","includes","add","push","newArrr","filter","item"],"version":3,"file":"index.0f001c8a.js.map"}