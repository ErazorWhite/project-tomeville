{"mappings":"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","sources":["src/js/popup.js","src/js/localStorage.js","src/js/createMarkupModalShopList.js"],"sourcesContent":["import { BookAPI } from './bookAPI';\nimport storage from './localStorage';\nimport { createBookMarkup } from './createMarkupModalShopList';\n\nlet BOOK_ID;\nconst KEY_LS = 'booksInShopingList';\nlet BOOKS_IDS = {\n  id: [],\n};\nconst api = new BookAPI();\nconst { save, load } = storage;\n\nconst booksContainerEl = document.querySelector(\n  '[data-action=\"booksContainer\"]'\n);\nconst backdropEl = document.querySelector('.js-backdrop');\nconst markDataContainerEl = document.querySelector(\n  '[data-action=\"popup-data-markup\"]'\n);\nconst closePopupBtnEl = document.querySelector('.close-popup');\nconst addBookBtnEl = document.querySelector('.add-book-button');\nconst removeBookBtnEl = document.querySelector('.remove-book-button');\nconst removeBookTextEl = document.querySelector('.remove-book-text');\n\nbooksContainerEl.addEventListener('click', onBooksContainerClick);\nbackdropEl.addEventListener('click', onBackdropClick);\nclosePopupBtnEl.addEventListener('click', onCloseBtnClick);\naddBookBtnEl.addEventListener('click', onAddBookBtnClick);\nremoveBookBtnEl.addEventListener('click', onRemoveBookBtnClick);\n\nasync function onBooksContainerClick(e) {\n  e.preventDefault();\n  if (e.currentTarget === e.target) {\n    return;\n  }\n  if (e.target.dataset.role === 'see-more-btn') {\n    return;\n  }\n  try {\n    // Тут робимо запит і передаємо данні на відмальовку у функцію\n    BOOK_ID = e.target.closest('.book-card').dataset.id;\n    api.id = BOOK_ID;\n    const { book_image, title, author, description, buy_links } =\n      await api.getBooksById();\n    markDataContainerEl.innerHTML = createBookMarkup(\n      book_image,\n      title,\n      author,\n      description,\n      buy_links[0].url,\n      buy_links[1].url,\n      buy_links[2].url\n    );\n\n    // Звертаємося до локалки і перевіряємо наявність книжки, в залеж. від відповіді виводим кнопку\n    // додати або видалити\n    BOOKS_IDS = load(KEY_LS) || {\n      id: [],\n    };\n    if (BOOKS_IDS.id.includes(BOOK_ID)) {\n      showAddOrRemoveBtn(true);\n    } else {\n      showAddOrRemoveBtn(false);\n    }\n\n    window.addEventListener('keydown', onEscPress);\n    document.body.classList.add('show-popup');\n  } catch {\n    err => console.log(err.message);\n  }\n}\n\n// Показуємо кнопку в залежності від значення флажка true or false.\nfunction showAddOrRemoveBtn(bookInLs) {\n  if (bookInLs) {\n    removeBookBtnEl.removeAttribute('hidden');\n    removeBookTextEl.removeAttribute('hidden');\n  } else {\n    addBookBtnEl.removeAttribute('hidden');\n  }\n}\n\nfunction onAddBookBtnClick() {\n  // Записуємо данні в локал сторейдж\n  // Замінюємо кнопку на ремув\n  BOOKS_IDS.id.push(BOOK_ID);\n  save(KEY_LS, BOOKS_IDS);\n\n  addBookBtnEl.setAttribute('hidden', true);\n  removeBookBtnEl.removeAttribute('hidden');\n  removeBookTextEl.removeAttribute('hidden');\n}\n\nfunction onRemoveBookBtnClick() {\n  // Видаляємо дані з локалки\n  // Замінюємо кнопку на едд\n  const newArrr = BOOKS_IDS.id.filter(item => item !== BOOK_ID);\n  BOOKS_IDS.id = newArrr;\n  save(KEY_LS, BOOKS_IDS);\n  removeBookBtnEl.setAttribute('hidden', true);\n  removeBookTextEl.setAttribute('hidden', true);\n  addBookBtnEl.removeAttribute('hidden');\n}\n\nfunction onCloseBtnClick() {\n  window.removeEventListener('keydown', onEscPress);\n  document.body.classList.remove('show-popup');\n\n  addBookBtnEl.setAttribute('hidden', true);\n  removeBookBtnEl.setAttribute('hidden', true);\n  removeBookTextEl.setAttribute('hidden', true);\n}\n\nfunction onBackdropClick(e) {\n  if (e.currentTarget === e.target) {\n    onCloseBtnClick();\n  }\n}\n\nfunction onEscPress(e) {\n  if (e.code === 'Escape') {\n    onCloseBtnClick();\n  }\n}\n\nexport { BOOKS_IDS };\n","// Файлик для работы с локальным хранилищем\n\n// Использовать вот так\n// import storage from './storage';\n// const { save, load } = storage;\n// save(CONST_ID, data); // Запись в local storage\n// const playerNewTime = load(CONST_ID); // Чтение\n\nconst save = (key, value) => {\n  try {\n    const serializedState = JSON.stringify(value);\n    localStorage.setItem(key, serializedState);\n  } catch (error) {\n    console.error('Set state error: ', error.message);\n  }\n};\n\nconst load = key => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nconst remove = key => {\n  try {\n    localStorage.removeItem(key);\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nconst clear = () => {\n  try {\n    localStorage.clear();\n  } catch (error) {\n    console.error('Get state error: ', error.message);\n  }\n};\n\nexport default {\n  save,\n  load,\n  remove,\n  clear,\n};\n","export function createBookMarkup(\n  bookImg,\n  title,\n  author,\n  description,\n  urlAmaz,\n  urlApBooks,\n  urlBarnAndNob\n) {\n  return `<img src=\"${\n    bookImg || 'src/images/noimage/noImage-desk@2x.png'\n  }\" alt=\"book cover: ${title || 'No title'}\"\n  width=\"100\" height=\"100\">\n  <h2>${title || 'No title'}</h2>\n  <p>${author || 'No author'}</p>\n  <p>${description || 'No description'}</p>\n  <a href=\"${urlAmaz}\" target=\"_blank\" rel=\"noreferrer noopener\">Amazon</a>\n<a href=\"${urlApBooks}\" target=\"_blank\" rel=\"noreferrer noopener\">Apple Books</a>\n<a href=\"${urlBarnAndNob}\" target=\"_blank\" rel=\"noreferrer noopener\">Barnes and Noble</a>`;\n}\n"],"names":["$fed5289f9aa3b6b0$var$BOOK_ID","$bpxeT","parcelRequire","$0aa9cd13c14a6e1e$export$2e2bcd8739ae039","save","key","value","serializedState","JSON","stringify","localStorage","setItem","error","console","message","load","getItem","undefined","parse","remove","removeItem","clear","$40a8bc062ec8249c$export$fc330cc8afb2a391","bookImg","title","author","description","urlAmaz","urlApBooks","urlBarnAndNob","concat","$fed5289f9aa3b6b0$var$KEY_LS","$fed5289f9aa3b6b0$export$1381f8da19e39170","id","$fed5289f9aa3b6b0$var$api","$2PuEF","BookAPI","$fed5289f9aa3b6b0$var$save","$fed5289f9aa3b6b0$var$load","$fed5289f9aa3b6b0$var$booksContainerEl","document","querySelector","$fed5289f9aa3b6b0$var$backdropEl","$fed5289f9aa3b6b0$var$markDataContainerEl","$fed5289f9aa3b6b0$var$closePopupBtnEl","$fed5289f9aa3b6b0$var$addBookBtnEl","$fed5289f9aa3b6b0$var$removeBookBtnEl","$fed5289f9aa3b6b0$var$removeBookTextEl","$fed5289f9aa3b6b0$var$_onBooksContainerClick","$parcel$interopDefault","$2TvXO","mark","_callee","e","ref","book_image","buy_links","preventDefault","currentTarget","target","dataset","role","closest","getBooksById","_ctx","sent","innerHTML","url","includes","$fed5289f9aa3b6b0$var$showAddOrRemoveBtn","window","addEventListener","$fed5289f9aa3b6b0$var$onEscPress","body","classList","add","apply","this","arguments","bookInLs","removeAttribute","$fed5289f9aa3b6b0$var$onCloseBtnClick","removeEventListener","setAttribute","code","push","newArrr","filter","item"],"version":3,"file":"index.eb03e010.js.map"}